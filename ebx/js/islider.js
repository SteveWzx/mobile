(function(){var B,A,F,E,D,C;B=function(){var G=function(H){if(!H.dom){throw new Error("dom element can not be empty!")}if(!H.data||!H.data.length){throw new Error("data must be an array and must have more than one element!")}this._opts=H;this._setting();this._renderHTML();this._bindHandler()};G.prototype._setting=function(){var H=this._opts;this.wrap=H.dom;this.data=H.data;this.type=H.type||"pic";this.isVertical=H.isVertical||false;this.isOverspread=H.isOverspread||false;this.duration=H.duration||2000;this.initIndex=H.initIndex||0;this.fixPage=H.fixPage||true;if(this.initIndex>this.data.length-1||this.initIndex<0){this.initIndex=0}this.slideIndex=this.slideIndex||this.initIndex||0;this.axis=this.isVertical?"Y":"X";this.reverseAxis=this.axis==="Y"?"X":"Y";this.width=this.wrap.clientWidth;this.height=this.wrap.clientHeight;this.ratio=this.height/this.width;this.scale=H.isVertical?this.height:this.width;this.onslide=H.onslide;this.onslidestart=H.onslidestart;this.onslideend=H.onslideend;this.onslidechange=H.onslidechange;this.isLoading=H.isLoading;this.offset=this.offset||{X:0,Y:0};this.useZoom=H.useZoom||false;if(this.data.length<2){this.isLooping=false;this.isAutoPlay=false}else{this.isLooping=H.isLooping||false;this.isAutoplay=H.isAutoplay||false}if(H.animateType==="card"&&this.isVertical){this.isOverspread=true}if(this.isAutoplay){this.play()}if(this.useZoom){this._initZoom(H)}this.log=H.isDebug?function(I){window.console.log(I)}:function(){};this._setUpDamping();this._setPlayWhenFocus();this._animateFunc=H.animateType in this._animateFuncs?this._animateFuncs[H.animateType]:this._animateFuncs["default"]};G.prototype._setPlayWhenFocus=function(){window.addEventListener("focus",this,false);window.addEventListener("blur",this,false)};G.prototype._animateFuncs={"default":function(J,K,L,H,I){J.style.webkitTransform="translateZ(0) translate"+K+"("+(I+L*(H-1))+"px)"}};G.prototype._setUpDamping=function(){var H=this.scale>>1;var I=H>>1;var J=I>>2;this._damping=function(M){var L=Math.abs(M);var K;if(L<H){K=L>>1}else{if(L<H+I){K=I+(L-H>>2)}else{K=I+J+(L-H-I>>3)}}return M>0?K:-K}};G.prototype._renderItem=function(L,H){var J;var K;var N=this.data.length;var O=this;var I=function(){K=J.height/J.width>O.ratio?'<img height="'+O.height+'" src="'+J.content+'">':'<img width="'+O.width+'" src="'+J.content+'">';L.innerHTML=K};if(!this.isLooping){J=this.data[H]||{empty:true}}else{if(H<0){J=this.data[N+H]}else{if(H>N-1){J=this.data[H-N]}else{J=this.data[H]}}}if(J.empty){L.innerHTML="";L.style.background="";return}if(this.type==="pic"){if(!this.isOverspread){if(J.height&J.width){I()}else{var M=new Image();M.src=J.content;M.onload=function(){J.height=M.height;J.width=M.width;I()}}}else{L.style.background="url("+J.content+") 50% 50% no-repeat";L.style.backgroundSize="cover"}}else{if(this.type==="dom"){L.innerHTML=J.content}}};G.prototype._renderHTML=function(){this.outer&&(this.outer.innerHTML="");var K=this.outer||document.createElement("ul");K.className="islider-outer";K.style.cssText="height:"+this.height+"px;width:"+this.width+"px;margin:0;padding:0;list-style:none;";if(this.type==="pic"&&!this.loader&&this.isLoading){var I=document.createElement("div");I.className="islider-loader";this.loader=I;this.wrap.appendChild(I)}this.els=[];for(var J=0;J<3;J++){var H=document.createElement("li");H.className=this.type==="dom"?"islider-dom":"islider-pic";H.style.cssText="height:"+this.height+"px;width:"+this.width+"px;";this.els.push(H);this._animateFunc(H,this.axis,this.scale,J,0);if(this.isVertical&&(this._opts.animateType==="rotate"||this._opts.animateType==="flip")){this._renderItem(H,1-J+this.slideIndex)}else{this._renderItem(H,J-1+this.slideIndex)}K.appendChild(H)}this._initLoadImg();if(!this.outer){this.outer=K;this.wrap.appendChild(K)}};G.prototype._preloadImg=function(L){var H=this.data.length;var M=L;var K=this;var I=function(P){if(P>-1&&!K.data[P].loaded){var O=new Image();O.src=K.data[P].content;O.onload=function(){K.data[P].width=O.width;K.data[P].height=O.height};K.data[P].loaded=1}};if(K.type!=="dom"){var J=M+2>H-1?(M+2)%H:M+2;var N=M-2<0?H-2+M:M-2;I(J);I(N)}};G.prototype._initLoadImg=function(){var M=this.data;var H=M.length;var L=this.initIndex;var K=this;if(this.type!=="dom"&&H>3){var J=L+2>H?(L+1)%H:L+1;var I=L-1<0?H-1+L:L-1;M[L].loaded=1;M[J].loaded=1;if(K.isLooping){M[I].loaded=1}setTimeout(function(){K._preloadImg(L)},200)}};G.prototype.slideTo=function(M){var K=this.data;var J=this.els;var L=M;var I=M-this.slideIndex;if(Math.abs(I)>1){var N=I>0?this.els[2]:this.els[0];this._renderItem(N,L)}this._preloadImg(L);if(K[L]){this.slideIndex=L}else{if(this.isLooping){this.slideIndex=I>0?0:K.length-1}else{this.slideIndex=this.slideIndex;I=0}}this.log("pic idx:"+this.slideIndex);var O;if(this.isVertical&&(this._opts.animateType==="rotate"||this._opts.animateType==="flip")){if(I>0){O=J.pop();J.unshift(O)}else{if(I<0){O=J.shift();J.push(O)}}}else{if(I>0){O=J.shift();J.push(O)}else{if(I<0){O=J.pop();J.unshift(O)}}}if(I!==0){if(Math.abs(I)>1){this._renderItem(J[0],L-1);this._renderItem(J[2],L+1)}else{if(Math.abs(I)===1){this._renderItem(O,L+I)}}O.style.webkitTransition="none";O.style.visibility="hidden";setTimeout(function(){O.style.visibility="visible"},200);this.onslidechange&&this.onslidechange(this.slideIndex);this.dotchange&&this.dotchange()}for(var H=0;H<3;H++){if(J[H]!==O){J[H].style.webkitTransition="all .3s ease"}this._animateFunc(J[H],this.axis,this.scale,H,0)}if(this.isAutoplay&&!this.isLooping&&this.slideIndex===K.length-1){this.pause()}};G.prototype._device=function(){var I=!!("ontouchstart" in window||window.DocumentTouch&&document instanceof window.DocumentTouch);var J=I?"touchstart":"mousedown";var H=I?"touchmove":"mousemove";var K=I?"touchend":"mouseup";return{hasTouch:I,startEvt:J,moveEvt:H,endEvt:K}};G.prototype._bindHandler=function(){var I=this.outer;var H=this._device();if(!H.hasTouch){I.style.cursor="pointer";I.ondragstart=function(J){if(J){return false}return true}}I.addEventListener(H.startEvt,this);I.addEventListener(H.moveEvt,this);I.addEventListener(H.endEvt,this);window.addEventListener("orientationchange",this)};G.prototype.bind=G.prototype.delegate=function(J,I,K){function H(P){var M=window.event?window.event:P;var N=M.target;var L=document.querySelectorAll(I);for(var O=0;O<L.length;O++){if(N===L[O]){K.call(N);break}}}this.wrap.addEventListener(J,H,false)};G.prototype.destroy=function(){var I=this.outer;var H=this._device();I.removeEventListener(H.startEvt,this);I.removeEventListener(H.moveEvt,this);I.removeEventListener(H.endEvt,this);window.removeEventListener("orientationchange",this);window.removeEventListener("focus",this);window.removeEventListener("blur",this);this.wrap.innerHTML=""};G.prototype.handleEvent=function(I){var H=this._device();switch(I.type){case H.startEvt:this.startHandler(I);break;case H.moveEvt:this.moveHandler(I);break;case H.endEvt:this.endHandler(I);break;case"touchcancel":this.endHandler(I);break;case"orientationchange":this.orientationchangeHandler();break;case"focus":this.isAutoplay&&this.play();break;case"blur":this.pause();break}};G.prototype.startHandler=function(I){if(this.fixPage){var J=I.target;if(J.tagName!=="SELECT"&&J.tagName!=="INPUT"&&J.tagName!=="TEXTAREA"){I.preventDefault()}}var H=this._device();this.isMoving=true;this.pause();this.onslidestart&&this.onslidestart();this.log("Event: beforeslide");this.startTime=new Date().getTime();this.startX=H.hasTouch?I.targetTouches[0].pageX:I.pageX;this.startY=H.hasTouch?I.targetTouches[0].pageY:I.pageY;this._startHandler&&this._startHandler(I)};G.prototype.moveHandler=function(I){if(this.isMoving){var M=this._device();var O=this.data.length;var K=this.axis;var L=this.reverseAxis;var P={X:M.hasTouch?I.targetTouches[0].pageX-this.startX:I.pageX-this.startX,Y:M.hasTouch?I.targetTouches[0].pageY-this.startY:I.pageY-this.startY};var H=this._moveHandler?this._moveHandler(I):false;if(!H&&Math.abs(P[K])-Math.abs(P[L])>10){I.preventDefault();this.onslide&&this.onslide(P[K]);this.log("Event: onslide");if(!this.isLooping){if(P[K]>0&&this.slideIndex===0||P[K]<0&&this.slideIndex===O-1){P[K]=this._damping(P[K])}}for(var N=0;N<3;N++){var J=this.els[N];J.style.webkitTransition="all 0s";this._animateFunc(J,K,this.scale,N,P[K])}}this.offset=P}};G.prototype.endHandler=function(I){this.isMoving=false;var P=this.offset;var L=this.axis;var N=this.scale/2;var O=new Date().getTime();N=O-this.startTime>300?N:14;var H=this._endHandler?this._endHandler(I):false;var K=Math.abs(P[L]);var M=Math.abs(P[this.reverseAxis]);var J=function(Q){if(Q.tagName==="A"){if(Q.href){window.location.href=Q.href;return false}}else{if(Q.className==="islider-dom"){return false}else{J(Q.parentNode)}}};if(!H&&P[L]>=N&&M<K){this.slideTo(this.slideIndex-1)}else{if(!H&&P[L]<-N&&M<K){this.slideTo(this.slideIndex+1)}else{if(!H){this.slideTo(this.slideIndex)}}}if(Math.abs(this.offset.X)<10&&Math.abs(this.offset.Y)<10){this.tapEvt=document.createEvent("Event");this.tapEvt.initEvent("tap",true,true);if(this.fixPage){J(I.target)}if(!I.target.dispatchEvent(this.tapEvt)){I.preventDefault()}}this.offset.X=this.offset.Y=0;this.isAutoplay&&this.play();this.onslideend&&this.onslideend(this.slideIndex);this.log("Event: afterslide")};G.prototype.orientationchangeHandler=function(){setTimeout(function(){this.reset();this.log("Event: orientationchange")},100)};G.prototype.reset=function(){this.pause();this._setting();this._renderHTML();this.isAutoplay&&this.play()};G.prototype.play=function(){var I=this;var H=this.duration;clearInterval(this.autoPlayTimer);this.autoPlayTimer=setInterval(function(){I.slideTo(I.slideIndex+1)},H)};G.prototype.pause=function(){clearInterval(this.autoPlayTimer)};G.prototype.extend=function(H,I){if(!I){I=G.prototype}Object.keys(H).forEach(function(J){Object.defineProperty(I,J,Object.getOwnPropertyDescriptor(H,J))})};return G}();A=undefined;F=function(G){var H={"rotate":function(O,L,J,M,P){var I=L==="X"?"Y":"X";var N=Math.abs(P);var K=window.getComputedStyle(this.wrap.parentNode,null).backgroundColor;if(this.isVertical){P=-P}this.wrap.style.webkitPerspective=J*4;if(M===1){O.style.zIndex=J-N}else{O.style.zIndex=P>0?(1-M)*N:(M-1)*N}O.style.cssText+="-webkit-backface-visibility:hidden; -webkit-transform-style:preserve-3d; background-color:"+K+"; position:absolute;";O.style.webkitTransform="rotate"+I+"("+90*(P/J+M-1)+"deg) translateZ("+0.888*J/2+"px) scale(0.888)"},"flip":function(L,M,O,I,K){var N=M==="X"?"Y":"X";var J=window.getComputedStyle(this.wrap.parentNode,null).backgroundColor;if(this.isVertical){K=-K}this.wrap.style.webkitPerspective=O*4;if(K>0){L.style.visibility=I>1?"hidden":"visible"}else{L.style.visibility=I<1?"hidden":"visible"}L.style.cssText+="position:absolute; -webkit-backface-visibility:hidden; background-color:"+J+";";L.style.webkitTransform="translateZ("+O/2+"px) rotate"+N+"("+180*(K/O+I-1)+"deg) scale(0.875)"},"depth":function(L,M,N,J,K){var I=(4-Math.abs(J-1))*0.18;this.wrap.style.webkitPerspective=N*4;L.style.zIndex=J===1?100:K>0?1-J:J-1;L.style.webkitTransform="scale("+I+", "+I+") translateZ(0) translate"+M+"("+(K+1.3*N*(J-1))+"px)"},"flow":function(P,L,J,N,Q){var O=Math.abs(Q);var I=L==="X"?"Y":"X";var M=L==="X"?1:-1;var K=Math.abs(Q/J);this.wrap.style.webkitPerspective=J*4;if(N===1){P.style.zIndex=J-O}else{P.style.zIndex=Q>0?(1-N)*O:(N-1)*O}P.style.webkitTransform="scale(0.7, 0.7) translateZ("+(K*150-150)*Math.abs(N-1)+"px)translate"+L+"("+(Q+J*(N-1))+"px)rotate"+I+"("+M*(30-K*30)*(1-N)+"deg)"},"card":function(M,N,O,J,L){var K=Math.abs(L);if(J===1){M.style.zIndex=O-K;M.cur=1}else{M.style.zIndex=L>0?(1-J)*K*1000:(J-1)*K*1000}if(M.cur&&M.cur!==J){setTimeout(function(){M.cur=null},300)}var I=M.cur?1-0.2*Math.abs(J-1)-Math.abs(0.2*L/O).toFixed(6):1;M.style.webkitTransform="scale("+I+", "+I+") translateZ(0) translate"+N+"("+((1+Math.abs(J-1)*0.2)*L+O*(J-1))+"px)"}};G.prototype.extend(H,G.prototype._animateFuncs)}(B);E=function(W){var J="WebKitCSSMatrix" in window&&"m11" in new WebKitCSSMatrix();var G=1/2;var Q={};function b(c,d,e,f){return"translate"+(J?"3d(":"(")+c+"px,"+d+(J?"px,"+e+"px)":"px)")+"scale("+f+")"}function Z(e,f){var c,d;c=e.left-f.left;d=e.top-f.top;return Math.sqrt(c*c+d*d)}function M(c,d){return c+"px "+d+"px"}function X(c){return Array.prototype.slice.call(c).map(function(d){return{left:d.pageX,top:d.pageY}})}function L(d,e){var c=Z(d[0],d[1]);var f=Z(e[0],e[1]);return f/c}function S(c){var m={translateX:0,translateY:0,translateZ:0,scaleX:1,scaleY:1,offsetX:0,offsetY:0};var j=0,g=0;if(!window.getComputedStyle||!c){return m}var l=window.getComputedStyle(c),f,d;f=l.webkitTransform||l.mozTransform;d=l.webkitTransformOrigin||l.mozTransformOrigin;var k=d.match(/(.*)px\s+(.*)px/);if(k.length>1){j=k[1]-0;g=k[2]-0}if(f=="none"){return m}var i=f.match(/^matrix3d\((.+)\)$/);var e=f.match(/^matrix\((.+)\)$/);if(i){var h=i[1].split(", ");m={translateX:h[12]-0,translateY:h[13]-0,translateZ:h[14]-0,offsetX:j-0,offsetY:g-0,scaleX:h[0]-0,scaleY:h[5]-0,scaleZ:h[10]-0}}else{if(e){var h=e[1].split(", ");m={translateX:h[4]-0,translateY:h[5]-0,offsetX:j-0,offsetY:g-0,scaleX:h[0]-0,scaleY:h[3]-0}}}return m}function U(c,d){return{x:(c.x+d.x)/2,y:(c.y+d.y)/2}}function O(c){this.currentScale=1;this.zoomFactor=c.zoomFactor||2}function P(d){if(this.useZoom){var i=this.els[1].querySelector("img");var h=S(i);this.startTouches=X(d.targetTouches);this._startX=h.translateX-0;this._startY=h.translateY-0;this.currentScale=h.scaleX;this.zoomNode=i;var e=Y(i);if(d.targetTouches.length==2){console.log("gesture");this.lastTouchStart=null;var g=d.touches;var c=U({x:g[0].pageX,y:g[0].pageY},{x:g[1].pageX,y:g[1].pageY});i.style.webkitTransformOrigin=M(c.x-e.left,c.y-e.top)}else{if(d.targetTouches.length===1){var f=new Date().getTime();this.gesture=0;if(f-this.lastTouchStart<300){d.preventDefault();this.gesture=3}this.lastTouchStart=f}}}}function a(e){var d=0,f=this.zoomNode;var c=this._device();if(c.hasTouch){if(e.targetTouches.length===2&&this.useZoom){f.style.webkitTransitionDuration="0";e.preventDefault();this._scaleImage(e);d=2}else{if(e.targetTouches.length==1&&this.useZoom&&this.currentScale>1){f.style.webkitTransitionDuration="0";e.preventDefault();this._moveImage(e);d=1}}this.gesture=d;return d}}function N(d){var c=this.zoomFactor||2;var f=this.zoomNode;var e=Y(f);this.currentScale=this.currentScale==1?c:1;f.style.webkitTransform=b(0,0,0,this.currentScale);if(this.currentScale!=1){f.style.webkitTransformOrigin=M(d.touches[0].pageX-e.left,d.touches[0].pageY-e.top)}}function K(d){var c=X(d.targetTouches);var f=L(this.startTouches,c);d.scale=d.scale||f;var e=this.zoomNode;f=this.currentScale*d.scale<G?G:this.currentScale*d.scale;e.style.webkitTransform=b(0,0,0,f)}function T(d){var c=0;if(this.gesture===2){this._resetImage(d);c=2}else{if(this.gesture==1){this._resetImage(d);c=1}else{if(this.gesture===3){this._handleDoubleTap(d);this._resetImage(d)}}}return c}function I(d){var f=this.zoomNode;var c=this._device();var e={X:c.hasTouch?d.targetTouches[0].pageX-this.startX:d.pageX-this.startX,Y:c.hasTouch?d.targetTouches[0].pageY-this.startY:d.pageY-this.startY};this.moveOffset={x:this._startX+e.X-0,y:this._startY+e.Y-0};f.style.webkitTransform=b(this.moveOffset.x,this.moveOffset.y,0,this.currentScale)}function Y(d){var c={"left":0,"top":0};do{c.top+=d.offsetTop||0;c.left+=d.offsetLeft||0;d=d.offsetParent}while(d);return c}function H(i,c,d){var e,h;var f=Y(i);Q={start:{left:f.left,top:f.top},end:{left:f.left+i.clientWidth,top:f.top+i.clientHeight}};var g=d==1?"left":"top";e=Q.start[g];h=Q.end[g];return c>=e&&c<=h}function V(i,f){var e=0;var c=H(i,f.start.left,1);var g=H(i,f.end.left,1);var d=H(i,f.start.top,0);var h=H(i,f.end.top,0);if(c!=g&&d!=h){if(c&&h){e=1}else{if(c&&d){e=2}else{if(g&&h){e=3}else{e=4}}}}else{if(c==g){if(!d&&h){e=5}else{if(!h&&d){e=6}}}else{if(d==h){if(!c&&g){e=7}else{if(c&&!g){e=8}}}else{if(d==h==c==g){e=9}}}}return e}function R(d){if(this.currentScale==1){return}var c=this.zoomNode,f,e,l,n,o,k,m,j,i,g;l=S(c);i=c.parentNode;n=c.clientWidth*l.scaleX;o=c.clientHeight*l.scaleX;k=Y(c);m={left:(1-l.scaleX)*l.offsetX+k.left+l.translateX,top:(1-l.scaleX)*l.offsetY+k.top+l.translateY};j={left:m.left+n,top:m.top+o};f=m.left;e=m.top;g=V(i,{start:m,end:j});switch(g){case 1:f=Q.start.left;e=Q.end.top-o;break;case 2:f=Q.start.left;e=Q.start.top;break;case 3:f=Q.end.left-n;e=Q.end.top-o;break;case 4:f=Q.end.left-n;e=Q.start.top;break;case 5:e=Q.end.top-o;break;case 6:e=Q.start.top;break;case 7:f=Q.end.left-n;break;case 8:f=Q.start.left;break}if(n<i.clientWidth){f=k.left-(l.scaleX-1)*c.clientWidth/2}if(o<i.clientHeight){e=k.top-(l.scaleX-1)*c.clientHeight/2}c.style.webkitTransitionDuration="100ms";c.style.webkitTransform=b(l.translateX+f-m.left,l.translateY+e-m.top,0,l.scaleX)}W.prototype.extend({_initZoom:O,_scaleImage:K,_moveImage:I,_resetImage:R,_handleDoubleTap:N,_moveHandler:a,_endHandler:T,_startHandler:P})}(B);D=function(G){G.prototype.extend({addBtn:function(){if(!this.isVertical){var J=[];var H=[];var K=this;for(var I=0;I<2;I++){J[I]=document.createElement("div");J[I].className="islider-btn-outer";H[I]=document.createElement("div");H[I].className="islider-btn-inner";if(I===0){J[I].className+=" left";J[I].dir=-1}else{J[I].className+=" right";J[I].dir=1}J[I].addEventListener("click",function(){var L=parseInt(this.getAttribute("dir"),10);K.slideTo(K.slideIndex+L)});J[I].appendChild(H[I]);this.wrap.appendChild(J[I],this.wrap.nextSibling)}}}})}(B);C=function(G){G.prototype.extend({addDot:function(){if(!this.isVertical){var K=this;var M=this.data;var L=[];var I=document.createElement("ul");I.className="islider-dot-wrap";var H=document.createDocumentFragment();for(var J=0;J<M.length;J++){L[J]=document.createElement("li");L[J].className="islider-dot";L[J].setAttribute("index",J);if(J===this.slideIndex){L[J].className+=" active"}L[J].addEventListener("click",function(){var N=parseInt(this.getAttribute("index"),10);K.slideTo(N)});H.appendChild(L[J])}I.appendChild(H);this.wrap.parentNode.appendChild(I);this.dotchange=function(){for(var N=0;N<M.length;N++){L[N].className="islider-dot";if(N===this.slideIndex){L[N].className+=" active"}}}}}})}(B);window.iSlider=B}());